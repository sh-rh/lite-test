# lite-test
Ваш .env файл должен выглядеть вот так
```
POSTGRES_SERVER=localhost
POSTGRES_PORT=5432
POSTGRES_DB=db
POSTGRES_USER=root
POSTGRES_PASSWORD=q


AWS_ACCESS_KEY_ID=YCAJEORQZaeNjxn3VtX1ACRQY
AWS_SECRET_ACCESS_KEY=YCMkvmSZCK-9sinlUDg7wA62-SndAK66PpSjXAj4
AWS_ENDPOIN_URL=https://storage.yandexcloud.net
AWS_REGION = 'ru-central1'
S3_BUCKET=test2-backet-lite
```
после просто запускается docker compose командой:
```
docker compose run
```

Тестовое задание
Задание желательно выполнить за максимум 3-4 вечера.

Напишите, когда ожидать выполнения задания в телеграм t.me/apresnyakov.

Когда закончите, скидывайте ссылку на github.

После ревью работы будет назначено интервью.

Процессинг изображений
Разработать api-интерфейс для высоконагруженной загрузки изображений.

Описание:

У вас есть поток загрузки фотографий. Примерно 130 000 штук за сутки, в среднем по 4 мб.

Придумать архитектуру и реализовать минимальный функционал по обработке фотографий.

Версии фоток:

Original
thumb: 150x120, to_fit
big_thumb: 700x700, to_fit
big_1920, 1920x1080, to_fit
d2500: 2500x2500, to_fit
to_fit - значит ресайзится по длинной стороне.

Технические ограниения:

Python, Web API
Можно использовать любую базу данных
Можно использовать любой S3 сервис, но лучше иметь в виду, что будем держать свой.
Минимальный функционал:

АПИ для загрузки с клиента. Запрос на загрузку, получение ссылки куда грузить файл.
Использование внешнего хранилища, s3
Использование docker-compose
Организация процессинга
Использовать веб сокеты для оповещения о готовности фотки.
Покрыть тестами, чтобы все проходило(И сокеты и API)
Дополнительно, написать предложение:

по масштабируемому процессингу - как организовать?
как сделать надежное свое s3 хранилище?
если будет желание, сделать минимальную веб версию для тестов

API примерное

POST /images/

REQUEST

{
 filename: 'hello.jpg', // имя файла для загрузки
 project_id: 111, // проект, в который грузится фотка
}

RESPONSE

{
   upload_link: '....',
   params: {} // Возможно параметры для POST запроса
}

GET /projects/{id}/images

RESPONSE

{
 images: [
  {
   image_id: '',
   state: 'init', // uploaded, processing, done, error
   project_id: '',
   versions: {
    original: '',
    thumb: '',
    big_thumb: '',
    big_1920: '',
    d2500: ''
   }
  }
 ]
}

Websockets

Когда фотка обработана, нужно получать событие по проекту. Клиент подписывается на проект, используя project_id, в момент, когда фотка обрабатывается, отправляется событие с обновлением статуса.
